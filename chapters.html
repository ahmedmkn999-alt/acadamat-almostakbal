<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø±Ø³</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="auth.js"></script>
    <style>
        body { background: #020617; color: white; font-family: sans-serif; }
        
        /* ðŸ›‘ Ù‡Ù†Ø§ Ø³Ø± Ø§Ù„ØªÙƒØ¨ÙŠØ± */
        .teacher-card {
            background: linear-gradient(180deg, #1e293b, #0f172a);
            border: 2px solid rgba(255,255,255,0.05);
            border-radius: 30px;
            padding: 30px;
            min-height: 300px; /* ÙƒØ§Ø±Øª Ø·ÙˆÙŠÙ„ */
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .teacher-card:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: #fbbf24;
            box-shadow: 0 20px 50px rgba(251, 191, 36, 0.2);
        }
        .teacher-img {
            width: 160px; height: 160px; /* ØµÙˆØ±Ø© Ø¶Ø®Ù…Ø© */
            border-radius: 50%;
            border: 5px solid #fbbf24;
            object-fit: cover; margin-bottom: 20px;
            background: #000;
        }
        .teacher-name {
            font-size: 1.8rem; /* Ø®Ø· ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹ */
            font-weight: 900; color: white; margin-bottom: 10px;
        }
        .badge {
            background: rgba(59, 130, 246, 0.2); color: #60a5fa;
            padding: 5px 20px; border-radius: 20px; font-weight: bold; font-size: 1rem;
        }
    </style>
</head>
<body class="p-6 md:p-10">
    <div id="app">
        <div class="flex items-center gap-4 mb-10">
            <button onclick="history.back()" class="bg-slate-800 w-14 h-14 rounded-full text-white text-2xl flex items-center justify-center">âžœ</button>
            <h1 class="text-3xl font-bold text-yellow-400">Ù†Ø®Ø¨Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†</h1>
        </div>

        <div v-if="loading" class="text-center mt-20 text-2xl animate-pulse">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        
        <div v-else class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div v-for="t in teachers" :key="t.id" @click="openTeacher(t)" class="teacher-card cursor-pointer">
                <img :src="t.image_url || 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png'" class="teacher-img">
                <h3 class="teacher-name">{{ t.name }}</h3>
                <span class="badge">
                     {{ (t.units ? t.units.length : 0) + (t.chapters ? t.chapters.length : 0) }} Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ
                </span>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;
        // Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¹Ø´Ø§Ù† Ø§Ù„Ø¯Ø§ØªØ§ ØªØ¸Ù‡Ø±
        const URLS = {
            'Ø¹Ù„Ù…ÙŠ Ø¹Ù„ÙˆÙ…': "https://plus-teal.vercel.app/organized_output.json",
            'Ø£Ø¯Ø¨ÙŠ': "https://plus-teal.vercel.app/organized_output-a.json", 
            'Ø¹Ù„Ù…ÙŠ Ø±ÙŠØ§Ø¶Ø©': "https://platform-sigma-seven.vercel.app/organized_output-e.json", 
            'Ø£Ø²Ù‡Ø±': "https://plus-teal.vercel.app/organized_output.json"
        };

        createApp({
            setup() {
                const teachers = ref([]);
                const loading = ref(true);
                const params = new URLSearchParams(window.location.search);
                const yid = params.get('yid');
                const sid = params.get('sid');

                const openTeacher = (t) => window.location.href = `lectures.html?yid=${yid}&sid=${sid}&tid=${t.id}`;

                onMounted(async () => {
                    const code = localStorage.getItem('activeCode');
                    const db = firebase.database();
                    const snap = await db.ref('approvedStudents/' + code).once('value');
                    const section = snap.val()?.section?.trim() || 'Ø¹Ù„Ù…ÙŠ Ø¹Ù„ÙˆÙ…';
                    
                    try {
                        const res = await fetch(URLS[section] || URLS['Ø¹Ù„Ù…ÙŠ Ø¹Ù„ÙˆÙ…']);
                        const data = await res.json();
                        const year = data.find(y => y.id == yid) || data[0];
                        const subject = year.subjects.find(s => s.id == sid);
                        teachers.value = subject.teachers || [];
                    } catch(e) {}
                    loading.value = false;
                });
                return { teachers, loading, openTeacher };
            }
        }).mount('#app');
    </script>
</body>
    </html>
    
