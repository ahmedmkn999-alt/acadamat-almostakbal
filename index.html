<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FULL MARK | بوابة الدخول</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #020617; color: white; font-family: 'Cairo', sans-serif; height: 100vh; display: flex; align-items: center; justify-content: center; margin: 0; overflow: hidden; }
        .stars { position: fixed; inset: 0; z-index: -1; background: radial-gradient(circle at 50% 50%, #1e1b4b 0%, #020617 100%); }
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0.5; animation: twinkle var(--d) infinite ease-in-out; }
        @keyframes twinkle { 0%, 100% { opacity: 0.3; transform: scale(1); } 50% { opacity: 1; transform: scale(1.3); } }
        
        /* التصميم الطولي الاحترافي */
        .login-card { 
            background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(20px); 
            border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 30px; 
            width: 85%; max-width: 360px; height: 80vh; /* تصميم طولي */
            padding: 40px 20px; box-shadow: 0 0 50px rgba(99, 102, 241, 0.2); 
            display: flex; flex-direction: column; justify-content: space-between; align-items: center;
        }
        .brand-logo { width: 70px; height: 70px; background: linear-gradient(135deg, #6366f1, #d946ef); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 2rem; transform: rotate(-5deg); box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3); }
        .brand-name { font-size: 2.2rem; font-weight: 900; margin-top: 15px; }
        .brand-name span { color: #6366f1; }
        
        input { width: 100%; padding: 18px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); background: rgba(2, 6, 23, 0.5); color: white; text-align: center; font-size: 1.1rem; outline: none; transition: 0.3s; }
        input:focus { border-color: #d946ef; box-shadow: 0 0 15px rgba(217, 70, 239, 0.3); }
        
        .btn-enter { width: 100%; padding: 18px; border-radius: 15px; border: none; background: linear-gradient(90deg, #6366f1, #d946ef); color: white; font-size: 1.2rem; font-weight: bold; cursor: pointer; transition: 0.3s; }
        
        /* صندوق الترحيب الذكي (صورة 1000079764) */
        .welcome-box { background: rgba(99, 102, 241, 0.15); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 20px; padding: 25px; width: 100%; display: none; text-align: center; }
        
        .footer-credit { font-size: 0.7rem; color: #475569; letter-spacing: 2px; }
        .footer-credit span { color: #6366f1; font-weight: bold; }
    </style>
</head>
<body>
    <div class="stars" id="starsBox"></div>
    <div class="login-card">
        <div class="top-section">
            <div class="brand-logo"><i class="fas fa-bolt text-white"></i></div>
            <h1 class="brand-name">FULL <span>MARK</span></h1>
        </div>

        <div id="loginFormArea" style="width: 100%;">
            <input type="tel" id="activationCode" placeholder="أدخل كود الطالب" autocomplete="off">
            <button onclick="login()" id="btnText" class="btn-enter mt-4">تسجيل الدخول <i class="fas fa-arrow-left mr-2"></i></button>
        </div>

        <div id="welcomeArea" class="welcome-box">
            <h3 class="text-indigo-400 font-bold mb-2">✅ أهلاً <span id="stdName">بطلنا</span></h3>
            <p class="text-xs text-indigo-200 opacity-70 animate-pulse">جاري الدخول للمنصة...</p>
            <button onclick="resetLogin()" class="text-[10px] text-red-400 underline mt-4 block mx-auto">حذف الكود والدخول بكود آخر</button>
        </div>

        <div class="footer-credit text-center">DESIGNED BY <span>AHMED MOHAMED</span></div>
    </div>

    <script>
        // توليد النجوم
        const box = document.getElementById('starsBox');
        for(let i=0; i<80; i++) {
            const s = document.createElement('div'); s.className='star';
            s.style.left=Math.random()*100+'%'; s.style.top=Math.random()*100+'%';
            s.style.width=s.style.height=Math.random()*2+1+'px';
            s.style.setProperty('--d', Math.random()*3+2+'s'); box.appendChild(s);
        }

        const firebaseConfig = { databaseURL: "https://fullmark-2025-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        window.onload = async () => {
            const code = localStorage.getItem('activeCode');
            if(code) {
                document.getElementById('loginFormArea').style.display = 'none';
                document.getElementById('welcomeArea').style.display = 'block';
                const snap = await db.ref('approvedStudents/'+code).once('value');
                if(snap.exists()) {
                    document.getElementById('stdName').innerText = snap.val().studentName;
                    setTimeout(() => location.href="subjects.html", 1500);
                } else { resetLogin(); }
            }
        };

        async function login() {
            const code = document.getElementById('activationCode').value.trim();
            if(!code) return alert("من فضلك أدخل الكود");
            document.getElementById('btnText').innerText = "...جاري التحقق";
            const snap = await db.ref('approvedStudents/'+code).once('value');
            if(snap.exists()) {
                localStorage.setItem('activeCode', code);
                location.href="subjects.html";
            } else { alert("الكود غير صحيح!"); document.getElementById('btnText').innerText="تسجيل الدخول"; }
        }

        function resetLogin() { localStorage.removeItem('activeCode'); location.reload(); }
    </script>
</body>
</html>
